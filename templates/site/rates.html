{% extends "base.html" %}

{% block content %}
  <!-- Header -->
  <header class="max-w-5xl mx-auto px-6 pt-8 pb-2 flex items-start justify-between">
    <div>
      <h1 class="text-4xl font-extrabold text-[var(--ink)]">Tipos de cambio</h1>
      <p class="text-lg text-[var(--muted)] leading-relaxed max-w-xl mt-1">
        Valores expresados hacia {{ destino_publico }}. Actualizados en tiempo real.
      </p>
    </div>
  </header>

  <main class="max-w-5xl mx-auto px-6 pb-10">
    {% if cotizaciones %}
      <section class="box box--tight no-padding">
        <div class="table-scroll table-wrap--max">
          <table class="table table--compact">
            <thead>
              <tr>
                <th>Par</th>
                <th class="text-right">Compra</th>
                <th class="text-right">Venta</th>
                <th class="text-right">Actualizado</th>
              </tr>
            </thead>
            <tbody>
              {% for r in cotizaciones %}
                <tr>
                  <td class="cell-strong">
                    <span class="currency-emoji" data-code="{{ r.codigo }}"></span>
                    {{ r.codigo }} â†’
                    <span class="currency-emoji" data-code="{{ destino_publico }}"></span>
                    {{ destino_publico }}
                  </td>
                  <td class="text-right">{{ r.valor_compra|floatformat:0 }}</td>
                  <td class="text-right">{{ r.valor_venta|floatformat:0 }}</td>
                  <td class="text-right">Hace {{ r.fecha_actualizacion|timesince }}</td>
                </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </section>
    {% else %}
      <p class="text-[var(--muted)]">No hay cotizaciones cargadas todavÃ­a.</p>
    {% endif %}
  </main>

  <script>
    // Mapeo de banderas (incluye PYG)
    (function(){
      const MAP={USD:"ðŸ‡ºðŸ‡¸",EUR:"ðŸ‡ªðŸ‡º",ARS:"ðŸ‡¦ðŸ‡·",BRL:"ðŸ‡§ðŸ‡·",CLP:"ðŸ‡¨ðŸ‡±",COP:"ðŸ‡¨ðŸ‡´",MXN:"ðŸ‡²ðŸ‡½",PEN:"ðŸ‡µðŸ‡ª",PYG:"ðŸ‡µðŸ‡¾",UYU:"ðŸ‡ºðŸ‡¾",GBP:"ðŸ‡¬ðŸ‡§",JPY:"ðŸ‡¯ðŸ‡µ",CNY:"ðŸ‡¨ðŸ‡³",AUD:"ðŸ‡¦ðŸ‡º",CAD:"ðŸ‡¨ðŸ‡¦",CHF:"ðŸ‡¨ðŸ‡­"};
      document.querySelectorAll('.currency-emoji').forEach(el=>{
        const code=String(el.dataset.code||'').toUpperCase();
        el.textContent=(MAP[code]||"ðŸ’±")+" ";
      });
    })();
  </script>
{% endblock %}
