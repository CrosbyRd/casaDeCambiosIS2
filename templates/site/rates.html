{% extends "base.html" %}
{% load l10n %}
{% block title %}Global Exchange{% endblock %}

{% block content %}
<main class="max-w-[1200px] mx-auto px-6 py-10">
  <h1 class="h1 mb-6">Tipos de cambio</h1>

  <section class="bg-white border rounded-xl shadow-sm overflow-hidden" style="border-color:var(--line)">
    <table class="w-full border-collapse">
      <thead class="bg-[var(--brand)] text-white">
        <tr>
          <th class="px-4 py-3 text-left">Moneda</th>
          <th class="px-4 py-3 text-right">Compra (PYG)</th>
          <th class="px-4 py-3 text-right">Venta (PYG)</th>
          <th class="px-4 py-3 text-right">ActualizaciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        {% for c in cotizaciones %}
          <tr class="border-b hover:bg-[var(--brand-soft)]" style="border-color:var(--line)">
            <td class="px-4 py-3">
              <span class="currency-emoji" data-code="{{ c.moneda_destino.codigo }}"></span>
              {{ c.moneda_destino.codigo }}
            </td>

            {# sin decimales #}
            <td class="px-4 py-3 text-right font-semibold">{{ c.total_compra|unlocalize|floatformat:0 }}</td>
            <td class="px-4 py-3 text-right font-semibold">{{ c.total_venta|unlocalize|floatformat:0 }}</td>

            <td class="px-4 py-3 text-right text-neutral-500">{{ c.fecha_actualizacion|date:"d/m/Y H:i" }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="4" class="px-4 py-6 text-center text-neutral-500">Sin cotizaciones.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </section>
</main>

<script>
(function(){
  const MAP = {USD:"ðŸ‡ºðŸ‡¸", EUR:"ðŸ‡ªðŸ‡º", ARS:"ðŸ‡¦ðŸ‡·", BRL:"ðŸ‡§ðŸ‡·", CLP:"ðŸ‡¨ðŸ‡±", COP:"ðŸ‡¨ðŸ‡´",
               MXN:"ðŸ‡²ðŸ‡½", PEN:"ðŸ‡µðŸ‡ª", PYG:"ðŸ‡µðŸ‡¾", UYU:"ðŸ‡ºðŸ‡¾", GBP:"ðŸ‡¬ðŸ‡§", JPY:"ðŸ‡¯ðŸ‡µ",
               CNY:"ðŸ‡¨ðŸ‡³", AUD:"ðŸ‡¦ðŸ‡º", CAD:"ðŸ‡¨ðŸ‡¦", CHF:"ðŸ‡¨ðŸ‡­"};
  document.querySelectorAll('.currency-emoji').forEach(el=>{
    const code = String(el.dataset.code||'').toUpperCase();
    el.textContent = (MAP[code] || "ðŸ’±") + " ";
  });
})();
</script>
{% endblock %}
