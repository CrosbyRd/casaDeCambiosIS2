{% extends "base.html" %}
{% load fx %}
{% block title %}Global Exchange — Tipos de cambio{% endblock %}
{% block content %}
<main id="main" class="max-w-[1200px] mx-auto px-6 py-8">
  <h1 class="h1 mb-6">Tipos de cambio</h1>

  <div class="overflow-x-auto border border-neutral-200 rounded-lg">
    <table class="min-w-full">
      <thead class="bg-neutral-50">
        <tr>
          <th class="text-left py-4 px-6">Par</th>
          <th class="text-right py-4 px-6">Compra</th>
          <th class="text-right py-4 px-6">Venta</th>
          <th class="text-right py-4 px-6">Actualizado</th>
        </tr>
      </thead>
      <tbody>
        {% for m in monedas %}
          {% with code=m.codigo|upper %}
          {% with item=fx.by_code|dict_get:code %}
          <tr class="border-t border-neutral-200">
            <td class="py-4 px-6"><span class="emoji">{{ code|flag }}</span> {{ code }} → 
              <span class="emoji">{{ "PYG"|flag }}</span> PYG </span>
            <td class="py-4 px-6 text-right">
              {% if code == "PYG" %}
                1
              {% elif item and item.pyg_per_unit %}
                {{ item.pyg_per_unit|floatformat:0 }}
              {% else %}
                —
              {% endif %}
            </td>
            <td class="py-4 px-6 text-right">
              {% if code == "PYG" %}
                1
              {% elif item and item.pyg_per_unit %}
                {{ item.pyg_per_unit|floatformat:0 }}
              {% else %}
                —
              {% endif %}
            </td>
            <td class="py-4 px-6 text-right">
              {% if fx.date %}{{ fx.date }}{% else %}—{% endif %}
            </td>
          </tr>
          {% endwith %}
          {% endwith %}
        {% empty %}
          <tr>
            <td colspan="4" class="py-6 px-6 text-neutral-600">Aún no has creado monedas en el admin.</td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if fx.date %}
    <p class="text-xs text-neutral-500 mt-2">Fuente: Currency API ({{ fx.date }})</p>
  {% endif %}
</main>
{% endblock %}
