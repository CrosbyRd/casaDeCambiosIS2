{% extends "base.html" %}
{% block title %}Global Exchange{% endblock %}

{% block content %}
<main class="max-w-4xl mx-auto px-6 py-10">

  <!-- Encabezado -->
  <header class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-4xl font-extrabold mb-2" style="color:var(--ink)">‚úèÔ∏è Editar Cliente</h1>
      <p class="text-lg leading-relaxed max-w-xl" style="color:var(--muted)">
        Modifica la informaci√≥n del cliente seleccionado y guarda los cambios.
      </p>
    </div>
    <a href="{% url 'clientes:lista' %}" class="px-4 py-2 rounded-lg font-bold bg-[var(--brand-soft)] hover:brightness-95"
       style="color:var(--brand-dark)">‚¨Ö Volver</a>
  </header>

  <!-- Formulario -->
  <section class="bg-white border rounded-xl shadow-sm overflow-hidden" style="border-color:var(--line)">
    <form method="post" id="form-cliente">
      {% csrf_token %}
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse min-w-[640px]">
          <!-- Encabezados -->
          <thead style="background:var(--brand); color:#fff">
            <tr>
              <th class="px-6 py-3">Nombre Completo *</th>
              <th class="px-6 py-3">Categor√≠a *</th>
            </tr>
          </thead>
          <!-- Inputs -->
          <tbody>
            <tr>
              <td class="px-6 py-4">
                <input type="text" name="nombre" id="id_nombre"
                       value="{{ form.instance.nombre }}"
                       placeholder="Ej: Juan P√©rez o Empresa XYZ"
                       class="w-full bg-white border border-gray-300 rounded-lg px-4 py-2 text-[var(--ink)] placeholder-gray-400
                              focus:outline-none focus:ring-2 focus:ring-[var(--brand)] focus:border-[var(--brand)] transition"/>
              </td>
              <td class="px-6 py-4">
                <select name="categoria" id="id_categoria"
                        class="w-full bg-white border border-gray-300 rounded-lg px-4 py-2 text-[var(--ink)]
                               focus:outline-none focus:ring-2 focus:ring-[var(--brand)] focus:border-[var(--brand)] transition">
                  <option value="minorista" {% if form.instance.categoria == 'minorista' %}selected{% endif %}>Minorista</option>
                  <option value="corporativo" {% if form.instance.categoria == 'corporativo' %}selected{% endif %}>Corporativo</option>
                  <option value="vip" {% if form.instance.categoria == 'vip' %}selected{% endif %}>VIP</option>
                </select>
              </td>
            </tr>
            <tr>
              <td colspan="2" class="px-6 py-4">
                <input type="hidden" name="activo" id="id_activo" value="{{ form.instance.activo|yesno:'true,false' }}">
                <button type="button" id="toggle-estado"
                        class="px-4 py-2 rounded-lg font-bold text-white {% if form.instance.activo %}bg-green-600 hover:bg-green-700{% else %}bg-red-600 hover:bg-red-700{% endif %}">
                  {% if form.instance.activo %}‚úÖ ACTIVO{% else %}‚ùå INACTIVO{% endif %}
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </form>
  </section>

  <!-- Botones debajo del formulario -->
  <div class="flex justify-end gap-3 pt-6">
    <a href="{% url 'clientes:lista' %}" 
       class="px-4 py-2 rounded-lg font-semibold bg-[var(--brand-soft)] hover:brightness-95"
       style="color:var(--brand-dark)">
      Cancelar
    </a>
    <button type="submit" form="form-cliente"
            class="px-6 py-2 rounded-lg font-bold text-white shadow-sm"
            style="background:var(--brand)">
      üíæ Guardar Cambios
    </button>
  </div>
</main>

<script>
  const toggleBtn = document.getElementById("toggle-estado");
  const inputActivo = document.getElementById("id_activo");

  toggleBtn.addEventListener("click", () => {
    if (inputActivo.value === "true") {
      inputActivo.value = "false";
      toggleBtn.textContent = "‚ùå INACTIVO";
      toggleBtn.classList.remove("bg-green-600", "hover:bg-green-700");
      toggleBtn.classList.add("bg-red-600", "hover:bg-red-700");
    } else {
      inputActivo.value = "true";
      toggleBtn.textContent = "‚úÖ ACTIVO";
      toggleBtn.classList.remove("bg-red-600", "hover:bg-red-700");
      toggleBtn.classList.add("bg-green-600", "hover:bg-green-700");
    }
  });
</script>
{% endblock %}
