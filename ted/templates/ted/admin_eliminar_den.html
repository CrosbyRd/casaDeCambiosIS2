{% extends "base.html" %}
{% block title %}Global Exchange{% endblock %}

{% block content %}
<main class="max-w-5xl mx-auto px-6 py-10">
  <!-- Encabezado -->
  <header class="mb-8">
    <h1 class="text-4xl font-extrabold text-red-600 flex items-center gap-2">
      🗑️ Eliminar denominación
    </h1>
    <p class="text-lg text-[var(--muted)] mt-2">
      Esta acción no se puede deshacer. Revisá la información antes de continuar.
    </p>
  </header>

  <!-- Tarjeta de confirmación -->
  <section class="bg-white border rounded-xl shadow-sm p-8" style="border-color:var(--line)">
  <form method="post">
    {% csrf_token %}
    <input type="hidden" name="ubicacion" value="{{ ubicacion }}">

    <p class="text-lg">
      ¿Confirmás que querés eliminar la denominación
      <span class="font-semibold">{{ den.moneda.codigo }} {{ den.valor }}</span>
      {% if ubicacion %} en la ubicación <span class="font-semibold">{{ ubicacion }}</span>{% endif %}?
    </p>

    {% if inv and inv.cantidad is not None %}
      <div class="mt-4 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-lg flex items-start gap-3">
        <span class="text-xl">⚠️</span>
        <span>Stock actual en esta ubicación: <strong>{{ inv.cantidad }}</strong>. Al eliminar aquí, el inventario se ajustará a <strong>0</strong> y se registrará el movimiento.</span>
      </div>
    {% endif %}

    {% if resumen_global %}
      <div class="mt-4 bg-indigo-50 border border-indigo-200 text-indigo-800 px-4 py-3 rounded-lg">
        <div class="font-semibold mb-1">Resumen global:</div>
        <ul class="list-disc pl-5">
          {% for r in resumen_global %}
            <li><strong>{{ r.ubicacion }}</strong>: {{ r.cantidad }}</li>
          {% endfor %}
        </ul>
        <div class="mt-2">Total global: <strong>{{ total_global }}</strong></div>
      </div>
    {% endif %}

    <div class="flex flex-col sm:flex-row justify-center gap-3 mt-6">
      <!-- Botón: solo esta ubicación -->
      <button type="submit" name="scope" value="ubicacion"
              class="px-5 py-2 rounded-lg font-semibold text-white bg-red-600 hover:bg-red-700 flex items-center gap-2">
        🗑️ <span>Eliminar SOLO en esta ubicación</span>
      </button>

      <!-- Botón: todas las ubicaciones + desactivar -->
      <button type="submit" name="scope" value="global"
              class="px-5 py-2 rounded-lg font-semibold text-white bg-red-700 hover:bg-red-800 flex items-center gap-2">
        🧯 <span>Eliminar en TODAS las ubicaciones y desactivar</span>
      </button>

      <a href="{% url 'admin_panel:ted:inventario' %}{% if ubicacion %}?ubicacion={{ ubicacion|urlencode }}{% endif %}"
         class="px-5 py-2 rounded-lg font-semibold text-white" style="background:var(--brand)">
        ✖ Cancelar
      </a>
    </div>
  </form>
</section>
</main>
{% endblock %}
