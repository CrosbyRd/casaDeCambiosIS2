{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <title>Listado de Cotizaciones ‚Äî Global Exchange</title>
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">
    <style>
        .total-row {
            background-color: #f8f9fa;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <main class="container container--tight">
        <header class="page-header page-header--tight">
            <h1 class="h1 h1--sm">Cotizaciones</h1>
            <a href="{% url 'cotizaciones:cotizacion_create' %}" class="btn">Agregar Cotizaci√≥n</a>
        </header>

        <section class="box box--tight no-padding">
            <div class="table-scroll table-wrap--max">
                <table class="table table--compact" id="cotizaciones-table">
                    <thead>
                        <tr>
                            <th>Moneda Base</th>
                            <th>Moneda Destino</th>
                            <th>Valor Compra</th>
                            <th>Comisi√≥n Compra</th>
                            <th>Total Compra</th>
                            <th>Valor Venta</th>
                            <th>Comisi√≥n Venta</th>
                            <th>Total Venta</th>
                            <th>√öltima Actualizaci√≥n</th>
                            <th>Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for c in cotizaciones %}
                        <tr>
                            <td class="cell-strong">
                                <span class="currency-emoji" data-code="{{ c.moneda_base.codigo }}"></span>
                                {{ c.moneda_base.nombre }} ({{ c.moneda_base.simbolo }})
                            </td>
                            <td class="cell-strong">
                                <span class="currency-emoji" data-code="{{ c.moneda_destino.codigo }}"></span>
                                {{ c.moneda_destino.nombre }} ({{ c.moneda_destino.simbolo }})
                            </td>
                            <td>{{ c.valor_compra }}</td>
                            <td>{{ c.comision_compra }}</td>
                            <td class="total-row">{{ c.total_compra }}</td>
                            <td>{{ c.valor_venta }}</td>
                            <td>{{ c.comision_venta }}</td>
                            <td class="total-row">{{ c.total_venta }}</td>
                            <td>{{ c.fecha_actualizacion }}</td>
                            <td>
                                <div style="display: inline-flex; gap: 0.5rem;">
                                    <a href="{% url 'cotizaciones:cotizacion_update' c.id %}" class="btn-secondary" style="display: inline-block;">Editar</a>
                                    <a href="{% url 'cotizaciones:cotizacion_delete' c.id %}" class="btn-ghost" style="display: inline-block;">Eliminar</a>
                                </div>
                            </td>
                        </tr>
                        {% empty %}
                        <tr>
                            <td colspan="10" class="empty">No hay cotizaciones registradas.</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Mapa de emojis por c√≥digo de moneda -->
    <script>
        (function(){
            const MAP = {
                USD:"üá∫üá∏", EUR:"üá™üá∫", ARS:"üá¶üá∑", BRL:"üáßüá∑", CLP:"üá®üá±", COP:"üá®üá¥",
                MXN:"üá≤üáΩ", PEN:"üáµüá™", PYG:"üáµüáæ", UYU:"üá∫üáæ", GBP:"üá¨üáß", JPY:"üáØüáµ",
                CNY:"üá®üá≥", AUD:"üá¶üá∫", CAD:"üá®üá¶", CHF:"üá®üá≠"
            };
            document.querySelectorAll('.currency-emoji').forEach(el => {
                const code = String(el.dataset.code || '').toUpperCase();
                el.textContent = (MAP[code] || "üí±") + " ";
            });
        })();
    </script>
</body>
</html>