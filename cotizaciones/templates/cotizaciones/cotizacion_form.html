{% extends "base.html" %}

{% block extra_head %}
<style>
  :root{
    --brand:#7c3aed; --brand-soft:#ede9fe; --brand-dark:#4c1d95;
    --ink:#111827; --muted:#6b7280; --line:#e5e7eb;
  }
  .ctrl{
    width:100%; max-width:380px; background:#fff; border:1.5px solid var(--line);
    border-radius:12px; padding:12px 14px; height:48px; font-size:1rem; color:var(--ink);
    box-shadow:0 1px 2px rgba(0,0,0,.03); transition:box-shadow .2s ease,border-color .2s ease;
  }
  .ctrl:focus{outline:none;border-color:var(--brand);box-shadow:0 0 0 3px rgba(115,60,255,.15);}
  .table-h{background:var(--brand);color:#fff}
  .muted{color:var(--muted)}
</style>
{% endblock %}

{% block content %}
<main class="max-w-5xl mx-auto px-6 py-10">
  <!-- Encabezado -->
  <header class="flex items-center justify-between mb-8">
    <div>
      <h1 class="text-4xl font-extrabold mb-2 text-[var(--ink)]">
        {% if object %}‚úèÔ∏è Editar cotizaci√≥n{% else %}‚ûï Crear cotizaci√≥n{% endif %}
      </h1>
      <p class="text-lg leading-relaxed max-w-2xl text-[var(--muted)]">
        Las cotizaciones p√∫blicas se muestran como <strong>DIVISA ‚Üí PYG</strong>. La moneda base se fija en <strong>PYG</strong>.
      </p>
    </div>
  </header>

  <!-- Formulario -->
  <section class="bg-white border rounded-xl shadow-sm" style="border-color:var(--line)">
    <form method="post" id="cotizacion-form" class="pb-6">
      {% csrf_token %}
      {% if form.non_field_errors %}
        <div class="mx-4 my-4 p-3 rounded-md bg-red-50 text-red-700">{{ form.non_field_errors }}</div>
      {% endif %}

      <!-- Par -->
      <table class="w-full border-collapse">
        <thead class="table-h">
          <tr>
            <th class="px-4 py-3 text-left">Moneda destino</th>
            <th class="px-4 py-3 text-left">Moneda base</th>
          </tr>
        </thead>
        <tbody>
          <tr class="hover:bg-[var(--brand-soft)]">
            <td class="px-4 py-3">
              {{ form.moneda_destino|add_class:"ctrl" }}
              {% for e in form.moneda_destino.errors %}<div class="text-red-600 text-sm mt-1">{{ e }}</div>{% endfor %}
            </td>
            <td class="px-4 py-3">
              <div class="ctrl flex items-center gap-2 justify-between">
                <span>Guaran√≠ paraguayo <span class="muted">(PYG)</span></span>
                <span>üáµüáæ</span>
              </div>
              <p class="muted text-sm mt-2">Se asigna autom√°ticamente.</p>
            </td>
          </tr>
        </tbody>
      </table>

      <!-- Compra -->
      <table class="w-full border-collapse mt-6">
        <thead class="table-h">
          <tr>
            <th class="px-4 py-3 text-left">Valor compra</th>
            <th class="px-4 py-3 text-left">Comisi√≥n compra</th>
          </tr>
        </thead>
        <tbody>
          <tr class="hover:bg-[var(--brand-soft)]">
            <td class="px-4 py-3">{{ form.valor_compra|add_class:"ctrl" }}{% for e in form.valor_compra.errors %}<div class="text-red-600 text-sm mt-1">{{ e }}</div>{% endfor %}</td>
            <td class="px-4 py-3">{{ form.comision_compra|add_class:"ctrl" }}{% for e in form.comision_compra.errors %}<div class="text-red-600 text-sm mt-1">{{ e }}</div>{% endfor %}</td>
          </tr>
        </tbody>
      </table>

      <!-- Venta -->
      <table class="w-full border-collapse mt-6">
        <thead class="table-h">
          <tr>
            <th class="px-4 py-3 text-left">Valor venta</th>
            <th class="px-4 py-3 text-left">Comisi√≥n venta</th>
          </tr>
        </thead>
        <tbody>
          <tr class="hover:bg-[var(--brand-soft)]">
            <td class="px-4 py-3">{{ form.valor_venta|add_class:"ctrl" }}{% for e in form.valor_venta.errors %}<div class="text-red-600 text-sm mt-1">{{ e }}</div>{% endfor %}</td>
            <td class="px-4 py-3">{{ form.comision_venta|add_class:"ctrl" }}{% for e in form.comision_venta.errors %}<div class="text-red-600 text-sm mt-1">{{ e }}</div>{% endfor %}</td>
          </tr>
        </tbody>
      </table>
    </form>
  </section>

  <!-- Acciones (fuera del recuadro, como Monedas) -->
  <div class="flex justify-end space-x-3 pt-4">
    <a href="{% url 'cotizaciones:cotizacion_list' %}"
       class="px-4 py-2 rounded-lg font-semibold text-white bg-red-600 hover:bg-red-700">
      Cancelar
    </a>
    <button type="submit" form="cotizacion-form"
            class="px-6 py-2 rounded-lg font-bold text-white shadow-sm"
            style="background:var(--brand)">
      üíæ {% if object %}Guardar cambios{% else %}Crear cotizaci√≥n{% endif %}
    </button>
  </div>
</main>
{% endblock %}
